<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}K-PIT{% endblock %}</title>
  </head>
  <body>
    {% block content %}{% endblock %}

    <!-- Idle timeout UX: warn at 14 min, force logout at 15 min -->
    <script>
      (function () {
        const WARN_MS = 14 * 60 * 1000;   // 14 minutes
        const LOGOUT_MS = 15 * 60 * 1000; // 15 minutes

        let warnTimer = null;
        let logoutTimer = null;

        function resetTimers() {
          if (warnTimer) clearTimeout(warnTimer);
          if (logoutTimer) clearTimeout(logoutTimer);

          warnTimer = setTimeout(() => {
            alert("No activity detected. You will be logged out in 1 minute for security.");
          }, WARN_MS);

          logoutTimer = setTimeout(() => {
            // Redirect to admin logout, then back to login
            window.location.href = "/admin/logout/";
          }, LOGOUT_MS);
        }

        // Reset on typical activity
        ["click", "mousemove", "keydown", "scroll", "touchstart"].forEach(evt => {
          window.addEventListener(evt, resetTimers, { passive: true });
        });

        resetTimers();
      })();
    </script>
  </body>
</html>
